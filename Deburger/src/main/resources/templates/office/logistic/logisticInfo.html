<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org/"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{common/layouts/layout}"
	  layout:fragment="Content">
<head>
<meta charset="UTF-8">

<title>Insert title here</title>
</head>
<body>

  <main id="main" class="main">

    <div class="pagetitle">
      <h1>업체 상세조회</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">공급업체 관리</a></li>
          <li class="breadcrumb-item active">업체 조회</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->
    
    

    <section class="section dashboard">

    <div class="row">
    <div class="col-lg-4">
    <!-- Website Traffic -->
          <div class="card">
            <div class="filter">
              <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
              <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                <li class="dropdown-header text-start">
                  <h6>Filter</h6>
                </li>

                <li><a class="dropdown-item" href="#">Today</a></li>
                <li><a class="dropdown-item" href="#">This Month</a></li>
                <li><a class="dropdown-item" href="#">This Year</a></li>
              </ul>
            </div>
            
            <div class="card-body pb-0">
              <h5 class="card-title"></h5>

              <div id="trafficChart" style="min-height: 400px;" class="echart"></div>

              <script>
                document.addEventListener("DOMContentLoaded", () => {
                  echarts.init(document.querySelector("#trafficChart")).setOption({
                    tooltip: {
                      trigger: 'item'
                    },
                    legend: {
                      top: '5%',
                      left: 'center'
                    },
                    series: [{
                      name: 'Access From',
                      type: 'pie',
                      radius: ['40%', '70%'],
                      avoidLabelOverlap: false,
                      label: {
                        show: false,
                        position: 'center'
                      },
                      emphasis: {
                        label: {
                          show: true,
                          fontSize: '18',
                          fontWeight: 'bold'
                        }
                      },
                      labelLine: {
                        show: false
                      },
                      
                      
                      data: [{
                          value: 100,
                          name: 'Search Engine'
                        },
                        {
                          value: 735,
                          name: 'Direct'
                        },
                        {
                          value: 580,
                          name: 'Email'
                        },
                        {
                          value: 484,
                          name: 'Union Ads'
                        },
                        {
                          value: 300,
                          name: 'Video Ads'
                        }
                      ] //end data
                      
                      
                    }]
                  });
                });
              </script>

            </div>
          </div><!-- End Website Traffic -->
          </div>
          
    

        <div class="col-lg-8">

          <div class="card">
            <div class="card-body">
              <h5 class="card-title">전체재고</h5>

              <!-- Table with hoverable rows -->
              <table class="table table-hover">
                <thead>
                  <tr>
                  	<th scope="col">NO</th>
                    <th scope="col">재료코드</th>
                    <th scope="col">재료명</th>
                    <th scope="col">수량</th>
                    <th scope="col">용량</th>
                    <th scope="col">유통기한</th>
                    <th scope="col">발주필요 재고</th>
                  </tr>
                </thead>
                <tbody>
	            <th:block th:each="info, stats : ${logistic}">
	            	<tr th:data-mid=${info.materialNumber} data-bs-toggle="modal" data-bs-target="#modalDialogScrollable">
	            		<td>[[ ${stats.count} ]]</td>
	            		<td>[[ ${info.materialNumber} ]]</td>
	            		<td>[[ ${info.materialName} ]]</td>
	            		<td>[[ ${info.stockCount} ]]개</td>
	            		<td>[[ ${info.unit} ]]</td>
	            		<td>[[ ${#dates.format(info.expirationLimit, 'yyyy-MM-dd')} ]]</td>
						<td th:text="${info.requireStock} < 0 ? '충분' : '부족' "></td>

              			<td th:if="${info.requireStock} < 0">충분</td>
						<td th:unless="${info.requireStock} < 0">부족</td>
						
	                </tr>
	            </th:block>
                </tbody>
              </table>
              <!-- End Table with hoverable rows -->
              
              

              <div class="modal fade" id="modalDialogScrollable" tabindex="-1">
                <div class="modal-dialog modal-dialog-scrollable">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">제품명 들어오자</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      Non omnis incidunt qui sed occaecati magni asperiores est mollitia. Soluta at et reprehenderit. Placeat autem numquam et fuga numquam. Tempora in facere consequatur sit dolor ipsum. Consequatur nemo amet incidunt est facilis. Dolorem neque recusandae quo sit molestias sint dignissimos.
                      <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
                      This content should appear at the bottom after you scroll.
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                  </div>
                </div>
              </div><!-- End Modal Dialog Scrollable-->

            </div>
          </div>
          
        </div>
    </div>

    </section>
	
  </main><!-- End #main -->
  
</body>




<script>
	
	$('tbody > tr').on('click', function(event) {
		

		let tr = event.currentTarget;
		let mid = $(tr).data('mid');
		console.log(mid);
		//let url = "http://localhost:8094/deburger/stockInfoAjax?materialNumber" + mid;
		

		
		$.ajax({
			url:"stockInfoAjax?materialNumber="+mid,
			method: "GET"
		})
		.done(data => {
			console.log(data);
		})
		.fail (err => console.log(err))

	});
	
	
	

</script>

</html>
<!-- 모달창 만들고, 모양 잡고, 모달창 위에 있는 데이터를 (document.get attr 해서 innerHTML) -->


<!--/*

	<td th:if="${info.requireStock} < 0">충분</td>
	<td th:unless="${info.requireStock} < 0">부족</td>
  
*/-->

<!--/* 

	$.ajax("/stockInfoAjax?materialNumber="+mid, {
      method : "get",
      //contentType : "application/json",
      //data : JSON.stringify({materialNumber : mid})
    })
    .done(data => {
    
     })
     .fail(err => console.log(err))
		
	});
	
 */-->