<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.deburger.app.shop.shoporder.mapper.ShopOrderMapper">

	<select id="selectShopOrder" parameterType="ShopOrderVO">
		select
		m.material_number
		,m.material_name
		,m.unit
		,o.count
		,m.sale_Unitprice
		from
		order_cart o join material m
		on m.material_number = o.material_number
		where o.store_number = 'FRC0000001'
		ORDER by m.material_number
	</select>

	<insert id="insertShopOrder" parameterType="ShopOrderVO">
			<selectKey keyProperty="orderNumber" resultType="String"
			order="BEFORE">
			select 'FOD' || LPAD(FOD_SEQ.nextval,'7',0) from dual
		</selectKey>
		Insert INTO store_Order(
			ORDER_NUMBER
			,ORDER_DAY
			,STORE_NUMBER
			,AUTO_ORDER_OPERATION
			,cancel_operation
			,note
			,person_id)
		values (
			#{orderNumber}
			,sysdate
			,#{storeNumber}
			,#{autoOrderOperation}
			,#{cancelOperation}
			,''
			,'')
	</insert>

	<insert id="dinsertShopOrder" parameterType="ShopOrderVO">

		Insert INTO Order_details(
			Order_details_number
			,count
			,Order_Number
		,MATERIAL_NUMBER)
		values (
			'FDO' || LPAD(FDO_SEQ.nextval,'7',0)
			,#{count}
			,#{orderNumber}
			,#{materialNumber})

	</insert>
	
	<delete id="deleteOrderCart">
	delete from order_cart
	where store_number=#{storeNumber}
	AND material_Number=#{materialNumber}
	</delete> 

</mapper>